# -*- coding: utf-8 -*-
"""DataCSV_177771.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1NVUfF3S3T2XTAdnyCGJJCypUEuWb9_VL
"""

import pandas as pd
pd.read_csv("STUDENT_GROUP.csv")

pd.read_csv("attendance.csv")

df_attendance=pd.read_csv("attendance.csv")
df_groups=pd.read_csv("STUDENT_GROUP.csv")

df_attendance.head()

df_groups.head()

df_groups.head(3)

df_groups.tail()

df_groups.tail(3)

df_groups.dtypes

df_attendance.dtypes

df_attendance.rename(columns={'STUDENT_ID':'student_id'}, inplace=True)

df_attendance.dtypes

# Convert to numeric, coercing errors
df_attendance['student_id'] = pd.to_numeric(df_attendance['student_id'], errors='coerce')

# Drop rows
df_attendance.dropna(subset=['student_id'], inplace=True)

#Convert to int64
df_attendance['student_id'] = df_attendance['student_id'].astype('int64')

df_attendance.describe()

# Merge
merged_df = pd.merge(df_attendance, df_groups, on='student_id', how='inner')

# Filter merged dataframe
filtered_df = merged_df[merged_df['student_id'].notna()]

# Display
filtered_df

# Filter merged dataframe
filtered_df = merged_df[merged_df['group_id'].str.contains('T48A')]

# Display
filtered_df

value_counts = filtered_df['DT'].value_counts().reset_index(name='Cuenta')
value_counts['Faltas']=23-value_counts['Cuenta']
value_counts['DT'] = pd.to_datetime(value_counts['DT'])
value_counts['Dia']=value_counts['DT'].dt.day_name()
value_counts
